---
title: "Cut text for later"
author: "Andee Kaplan"
date: "April 20, 2016"
output: html_document
---

We consider three related definitions of degeneracy as they relate to a graphical model. Section \ref{mean-parameterization} presents a definition from @handcock2003assessing based on the mean parameterization of the model parameters, section \ref{neg-potential} presents a definition from @schweinberger2011instability based on the neg-potential function, and section \ref{conditional-expectation} presents a definition from @kaiser2006markov that involves the difference between expectations of the model and expectations under independence.

which is characterized by excessive sensitivity and near-degeneracy

it is evident that the fraction of near-degenerate models simulated at specified magnitudes of $\boldsymbol \theta_{main}$ and $\boldsymbol \theta_{interaction}$ is more closely related to the combined distance from the origin of these two vectors, than any individual group of parameter values.

```{r}
three_ways %>% 
  mutate(dist = sqrt(r1^2 + r2^2)) %>% 
  group_by(N, dist) %>% 
  summarise(mean_max_q = mean(mean_max_q)) %>% 
  ggplot() + 
  geom_line(aes(N, mean_max_q, colour = dist, group = dist))
 
three_ways %>% 
  ggplot() + 
  geom_point(aes(mean_abs_diff, frac_degen), alpha = .3) +
  geom_smooth(aes(mean_abs_diff, frac_degen), method = "lm") +
  facet_grid(Hiddens ~ Visibles)

three_ways %>% group_by(Hiddens, Visibles) %>% summarise(corr = cor(mean_abs_diff, frac_degen))

```

```{r instab_plots, fig.cap="\\label{fig:instab_plots}A numerical experiment looking at $(\\max\\limits_{\\boldsymbol x_N \\in \\mathcal{X}_N}[Q(\\boldsymbol x_N)] - \\min\\limits_{\\boldsymbol x_N \\in \\mathcal{X}_N}[Q(\\boldsymbol x_N)])/N$ for each combination of magnitude of $\\boldsymbol \\theta$ and model size. As the magnitude of $\\boldsymbol \\theta$ grows, so does the value of this metric.", fig.height=4}
p.max_q
```

There are $H + V + H*V$ terms in the sum that comprises $Q(\boldsymbol x)$, which leads to a natural split of the quantity into main effects, those terms based solely on $h_i$ and $v_j$ and interaction effects, those terms based on the product of $h_i v_j$. There are $H+V$ main effects terms and $H*V$ interaction effects terms. For $H$ and $V$ large enough, the number of interaction terms is growing much faster than $H + V$, meaning no matter the $C$, we can restrict the size of the left side of equation \ref{eq:stable} effectively by restricting the size of the interaction terms. This points to the interaction terms as potentially the more dangerous parameters for causing instability in the RBM simply because there are so many more of them.


```{r interaction size, include=FALSE}
expand.grid(H = 1:10, V = 1:10) %>%
  mutate(interaction_terms = H*V) %>%
  ggplot() +
  geom_contour(aes(H, V, z = interaction_terms/(H + V), colour = ..level..), bins = 20) +
  geom_contour(aes(H, V, z = interaction_terms/(H + V)), colour = "black", breaks = 1) +
  scale_colour_gradient("H*V/(H + V)", low = "yellow", high = "red")

```